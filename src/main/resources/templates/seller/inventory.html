<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
    th:replace="~{fragments/base :: layout('Inventory - RevShop', ~{::section})}">

<head></head>

<body>
    <section class="container py-4">
        <!-- Header -->
        <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3">
            <div>
                <h2 class="fw-bold text-dark mb-0"><i class="fa-solid fa-boxes-stacked me-3 text-info"></i>Inventory
                    Management</h2>
                <p class="text-secondary small mt-1">Manage all your products in one place.</p>
            </div>
            <div class="d-flex gap-2">
                <a th:href="@{/seller/dashboard}"
                    class="btn btn-outline-secondary rounded-pill px-4 shadow-sm fw-bold">Back to Dashboard</a>
                <a th:href="@{/seller/product/new}" class="btn btn-primary rounded-pill px-4 shadow-sm fw-bold">
                    <i class="fa-solid fa-plus me-2"></i> Add Product
                </a>
            </div>
        </div>

        <!-- Success/Error Messages -->
        <div th:if="${msg}" class="alert alert-success shadow-sm mb-4"><i
                class="fa-solid fa-circle-check me-2"></i><span th:text="${msg}"></span></div>
        <div th:if="${error}" class="alert alert-danger shadow-sm mb-4"><i
                class="fa-solid fa-circle-exclamation me-2"></i><span th:text="${error}"></span></div>

        <!-- Inventory Table -->
        <div class="card border-0 shadow-sm rounded-4">
            <div class="card-body p-0 table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead class="table-light text-secondary">
                        <tr>
                            <th class="ps-4">Product Details</th>
                            <th>Category</th>
                            <th>Price</th>
                            <th>Stock</th>
                            <th>Status</th>
                            <th class="text-center pe-4">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="product : ${products}">
                            <td class="ps-4">
                                <div class="d-flex align-items-center">
                                    <img th:src="${product.imageUrl != null ? product.imageUrl : 'https://dummyimage.com/50x50/dee2e6/6c757d.jpg&text=No+Image'}"
                                        class="rounded shadow-sm me-3"
                                        style="width: 50px; height: 50px; object-fit: cover;" alt="Image">
                                    <div>
                                        <h6 class="mb-0 fw-bold text-dark text-truncate" style="max-width: 200px;"
                                            th:text="${product.name}">Product Name</h6>
                                        <small class="text-secondary" th:text="'ID: #' + ${product.id}">#123</small>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <span class="badge bg-light text-dark border border-secondary rounded-pill px-3 py-1"
                                    th:text="${product.category.name}">Category</span>
                            </td>
                            <td>
                                <div class="d-flex flex-column">
                                    <span th:if="${product.discountedPrice != null}">
                                        <span class="fw-bold text-success"
                                            th:text="'Rs.' + ${product.discountedPrice}">Rs.0.00</span>
                                        <span class="text-secondary small text-decoration-line-through ms-1"
                                            th:text="'Rs.' + ${product.price}">Rs.0.00</span>
                                    </span>
                                    <span th:unless="${product.discountedPrice != null}" class="fw-bold text-dark"
                                        th:text="'Rs.' + ${product.price}">Rs.0.00</span>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex align-items-center gap-2">
                                    <span class="fw-bold"
                                        th:classappend="${product.quantity <= 5 ? 'text-danger' : 'text-dark'}"
                                        th:text="${product.quantity}">0</span>
                                    <i th:if="${product.quantity <= 5}"
                                        class="fa-solid fa-triangle-exclamation text-warning" data-bs-toggle="tooltip"
                                        title="Low Stock!"></i>
                                </div>
                            </td>
                            <td>
                                <span th:if="${product.quantity > 0}"
                                    class="badge bg-success bg-opacity-10 text-success rounded-pill px-3 py-2"><i
                                        class="fa-solid fa-circle text-success me-1" style="font-size: 0.5em;"></i>
                                    Active</span>
                                <span th:if="${product.quantity <= 0}"
                                    class="badge bg-danger bg-opacity-10 text-danger rounded-pill px-3 py-2"><i
                                        class="fa-solid fa-circle text-danger me-1" style="font-size: 0.5em;"></i> Out
                                    of stock</span>
                            </td>
                            <td class="text-center pe-4">
                                <div class="d-flex justify-content-center gap-2">
                                    <a th:href="@{/seller/product/edit/{id}(id=${product.id})}"
                                        class="btn btn-sm btn-outline-primary rounded-circle custom-hover"
                                        data-bs-toggle="tooltip" title="Edit Product">
                                        <i class="fa-solid fa-pen"></i>
                                    </a>
                                    <form th:action="@{/seller/product/delete/{id}(id=${product.id})}" method="post"
                                        onsubmit="return confirm('Are you sure you want to delete this product?');">
                                        <button type="submit"
                                            class="btn btn-sm btn-outline-danger rounded-circle custom-hover"
                                            data-bs-toggle="tooltip" title="Delete Product">
                                            <i class="fa-solid fa-trash"></i>
                                        </button>
                                    </form>
                                </div>
                            </td>
                        </tr>

                        <tr th:if="${products == null or products.isEmpty()}">
                            <td colspan="6" class="text-center py-5">
                                <div class="py-4">
                                    <i class="fa-solid fa-box-open fs-1 text-secondary opacity-50 mb-3"></i>
                                    <h5 class="fw-bold text-dark">No products found</h5>
                                    <p class="text-secondary mb-4">You haven't added any products to your inventory yet.
                                    </p>
                                    <a th:href="@{/seller/product/new}"
                                        class="btn btn-primary rounded-pill px-4 shadow-sm fw-bold">Add Your First
                                        Product</a>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>
</body>

</html>